# 决策日志（Append-only）

> 只写 **✅定稿** 的内容；未定稿不要写进来。

## 记录格式
- ID：DEC-YYYYMMDD-序号
- 日期：YYYY-MM-DD
- 主题：一句话概括
- 决策：确定了什么（可执行）
- 影响范围：哪些模块/哪些文档要跟着变
- 理由：为什么这么定（1-3 条）
- 后续动作：要产出哪些工单/文档（含负责人/截止）

---

## DEC-20260209-000
- 日期：2026-02-09
- 主题：建立“定稿→日志→Codex工单”协作机制
- 决策：
  1) `定稿记录.txt` 作为需求与进度的基线文档；
  2) 新增 `log记录/决策日志.md`、`log记录/开发日志.md`、`log记录/Codex任务单.md` 三个 Append-only 文件；
  3) 只有对话中标注 **✅定稿** 的结论才允许写入“决策日志/任务单”。
- 影响范围：后续所有讨论结论、所有开发任务拆分方式。
- 理由：确保范围可控、记录可追溯、Codex 执行不走样。
- 后续动作：
  - 产出 `docs/CODEX_执行说明.md`（负责人：你；截止：今天）
  - 产出第一批 Codex 工单：工程骨架+RBAC（负责人：Codex；截止：本周）


## DEC-20260209-001 文档与日志体系建立
- 日期：2026-02-09  
- 决策：在工程根目录采用“`docs/` + `log记录/` + 基线文档”的体系管理项目。  
- 目录约定：  
  - `docs/`：长期稳定说明书（项目蓝图、技术框架书、接口与数据库、部署说明、测试用例、开发规范等）  
  - `log记录/`：可追溯日志（决策日志 / 开发日志 / Codex任务单）  
  - `定稿记录.txt`：作为需求与计划的基线参考（不作为每日变更日志）  
- 理由：避免聊天口头信息丢失；保证可追溯、可交付、可复现。

---

## DEC-20260209-002 日志写入规则与 Codex 协作机制
- 日期：2026-02-09  
- 决策：  
  1) `log记录/决策日志.md`：只记录确定结论（append-only）。  
  2) `log记录/开发日志.md`：记录推进情况/问题/讨论中内容。  
  3) `log记录/Codex任务单.md`：把“已定结论”拆成可执行 Task（含验收标准）。  
  4) Codex 读取优先级：`决策日志` > `Codex任务单` > `docs/` > `定稿记录.txt`。  
- 理由：让 Codex 始终以“最新确定结论”为准，减少误解与返工。

---

## DEC-20260209-003 当前阶段开发策略
- 日期：2026-02-09  
- 决策：先搭建“工程底座”，再推进业务闭环；底座包含：工程骨架 + 鉴权/RBAC + 数据模型 v1。  
- 理由：后续任务、报告、签到、设备、查重都依赖统一的用户/权限/日志/异常处理框架；先做底座最少返工。

---

## DEC-20260209-004 后端工程创建方式
- 日期：2026-02-09  
- 决策：后端工程优先使用 Spring Initializr（start.spring.io）生成标准 Spring Boot 项目骨架，再导入 IntelliJ 进行开发；不使用 Maven Archetype 来起 Spring Boot 项目。  
- 理由：Initializr 生成结构标准、依赖配置更稳定，减少手工拼装 pom 的坑。

---

## DEC-20260209-005 工程级技术栈默认方案（稳定优先）
- 日期：2026-02-09  
- 决策（默认执行）：  
  - 后端：Java 17 + Maven + Spring Boot（稳定版） + Spring Security + JWT + RBAC  
  - 数据库：MySQL；数据库版本管理：Flyway  
  - ORM：MyBatis-Plus（为主，复杂 SQL 允许手写）  
  - 接口文档：OpenAPI/Swagger（springdoc）  
  - 文件：本地存储（先规范目录与命名；对象存储后续再扩展）  
  - 前端：Vue3 + Vite + Element Plus + Pinia  
  - Redis：第一阶段不引入（降低环境复杂度），短期 token/临时数据先用本地缓存方案；需要并发/分布式时再上 Redis。  
- 理由：以“兼容好、少 bug、好部署”为第一目标；先跑通主链路再扩展中间件。

---
